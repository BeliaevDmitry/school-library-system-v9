<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head><meta charset="UTF-8"/><title>Админ</title><link rel="stylesheet" th:href="@{/css/app.css}"><script th:src="@{/js/table-filters.js}" defer></script></head>
<body>
<div class="container">
  <div class="top-back"><a href="#" onclick="history.back(); return false;">← Назад</a></div>
  <h2>Админ-панель</h2>

  <div class="card" th:if="${error}">
    <h3 style="margin-top:0">Ошибка</h3>
    <pre th:text="${error}"></pre>
  </div>
  <div class="card" th:if="${success}">
    <h3 style="margin-top:0">Готово</h3>
    <p th:text="${success}"></p>
  </div>

  <div class="actions">
    <a class="btn" th:href="@{/admin/planning}">Планирование закупки (будущий контингент)</a>
    <a class="btn" th:href="@{/admin/inventory}">Сводная инвентаризация</a>
    <a class="btn" th:href="@{/admin/classes}">Численность (редактирование)</a>
    <a class="btn" th:href="@{/admin/buildings}">Корпуса (редактировать названия)</a>
    <a class="btn" th:href="@{/admin/writeoff}">Списания (подтверждение заявок)</a>
  </div>
  <div class="card">
    <h3>Сводка фонда</h3>
    <p><b>Всего позиций:</b> <span th:text="${totalPositions}"></span></p>
    <p><b>Всего экземпляров:</b> <span th:text="${totalBooks}"></span></p>
    <table>
      <tr><th>Корпус</th><th>Позиции</th><th>Экземпляры</th></tr>
      <tr th:each="r : ${stockByBuilding}">
        <td th:text="${r.name + ' (код ' + r.code + ')'}"></td>
        <td th:text="${r.positions}"></td>
        <td th:text="${r.books}"></td>
      </tr>
    </table>
  </div>
  <div class="grid">
    <div class="card">
      <h3>Импорт данных</h3>
      <a th:href="@{/admin/import}">Перейти к импорту</a>
    </div>
    <div class="card">
      <h3>Сверка по корпусам</h3>
      <ul>
        <li th:each="b : ${buildings}">
          <a th:href="@{'/admin/reconciliation/' + ${b.id}}"
             th:text="${b.name + ' (код ' + b.code + ')'}"></a>
        </li>
      </ul>
    </div>
  </div>
  <a th:href="@{/logout}">Выйти</a>
</div>
</body>
</html>
